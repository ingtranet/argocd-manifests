apiVersion: v1
kind: Namespace
metadata:
  name: airflow

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: airflow
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://airflow.apache.org
    chart: airflow 
    targetRevision: 1.18.0
    helm:
      releaseName: airflow
      valuesObject:
        executor: "KubernetesExecutor"
        allowPodLaunching: true
        allowJobLaunching: true
        data:
          metadataSecretName: "metadata"
        fernetKeySecretName: "metadata"
        apiSecretKeySecretName: "metadata"
        migrateDatabaseJob:
          enabled: true
        jwtSecretName: "metadata"
        postgresql:
          enabled: false
        config:
          dag_processor:
            dag_bundle_config_list: '[{"name": "example_bundles", "classpath": "airflow.providers.git.bundles.git.GitDagBundle", "kwargs": {"tracking_ref": "main", "git_conn_id": "test"}}]'
  destination:
    server: https://kubernetes.default.svc
    namespace: airflow
