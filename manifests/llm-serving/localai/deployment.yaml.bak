apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: localai
  labels:
    app: localai
spec:
  selector:
    matchLabels:
      app: localai
  template:
    metadata:
      labels:
        app: localai
    spec:
      nodeSelector:
        nvidia.com/gpu.product: Orin
      runtimeClassName: nvidia
      containers:
        - name: localai
          image: localai/localai:v3.3.1-nvidia-l4t-arm64
          args:
            - "run"
            - "--log-level=debug"
          env:
            - name: NVIDIA_VISIBLE_DEVICES
              value: "all"
            - name: LOCALAI_MODELS_PATH
              value: /localai/models
            - name: LOCALAI_BACKENDS_PATH
              value: /localai/backends
          volumeMounts:
            - name: localai-volume
              mountPath: /localai
          ports:
            - name: http
              containerPort: 8080
      volumes:
        - name: localai-volume
          hostPath:
            path: /mnt/mfs/k8s/localai
            type: Directory
---
